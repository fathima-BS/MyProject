<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup - Bag Store</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/signup.css">
</head>
<body>
    <div id="signupContainer" class="signup-container">
        <div id="signupFormContainer" class="signup-form">
            <div id="signupCard" class="card">
                <h2 id="signupTitle" class="text-center">Sign Up</h2>
                <% if (message) { %>
                    <p style="color: red;"><%= message %></p>
                  <% } %>
                <form id="signupForm" action="/signup" method="post">
                    <div id="usernameField" class="mb-3">
                        <label for="username" class="form-label">Username</label>
                        <input type="text" id="username" class="form-control" name="username" placeholder="Enter username" >
                      <div id="error1" class="error-message"></div>
                    </div>
                    <div id="emailField" class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" id="email" class="form-control" name="email" placeholder="Enter email" >
                        <div id="error2" class="error-message"></div>
                    </div>
                    <div id="dobField" class="mb-3">
                        <label for="dob" class="form-label">Date of Birth</label>
                        <input type="date" id="dob" class="form-control" name="dateOfBirth" >
                        <div id="error3" class="error-message"></div>
                    </div>
                    <div id="passwordField" class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" id="password" class="form-control" name="password" placeholder="Enter password">
                        <div id="error4" class="error-message"></div>
                    </div>
                    <div id="confirmPasswordField" class="mb-3">
                        <label for="confirmPassword" class="form-label">Confirm Password</label>
                        <input type="password" id="confirmPassword" class="form-control" name="cPassword" placeholder="Confirm password">
                        <div id="error5" class="error-message"></div>
                    </div>
                    <button id="signupButton" type="submit" class="btn btn-dark w-100">Sign Up</button>
                </form>

                <p id="loginRedirect" class="text-center mt-3">
                    Already have an account? <a id="loginLink" class="text-dark" href="/login">Login</a>
                </p>
                <a href="/auth/google" id="googleSignupButton" class="btn btn-dark w-100 mt-2 d-flex align-items-center justify-content-center">
                    <img src="https://img.icons8.com/color/16/000000/google-logo.png" class="me-2" alt="Google Logo" />
                    Sign up with Google
                </a>                  
            </div>
        </div>

        <div id="signupBg" class="signup-bg"></div>
    </div>

    <script>
     const nameid=document.getElementById("username")
     const emailid=document.getElementById("email")
     const dateOfBirthid=document.getElementById("dob")
     const passid=document.getElementById("password")
     const confirmPassid=document.getElementById("cPassword")
     const error1=document.getElementById("error1")
     const error2=document.getElementById("error2")
     const error3=document.getElementById("error3")
     const error4=document.getElementById("error4")
     const error5=document.getElementById("error5")
     const signUpForm=document.getElementById("signupForm")

     function nameValidateChecking(e){
        const nameval=nameid.value
        const namepattern=/^[A-Za-z\s]+$/
        if(nameval.trim()===""){
            error1.style.display="block"
            error1.innerHTML="Please enter a valid name"
        }else if(!namepattern.test(nameval)){
           error1.style.display="block"
           error1.innerHTML="Name can only contain alpahabet and spaces"
        }else{
            error1.style.display="none"
            error1.innerHTML=""
        }
     }
     
      function emailValidateChecking(e){
         const emailval=emailid.value
         const emailpattern=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/
        
        if(!emailpattern.test(emailval)){
            error2.style.display="block"
            error2.innerHTML="Invalid Format"
        }else{
            error2.style.display="none"
            error2.innerHTML=""
        }
      }
      
      function dobValidateChecking(e){
        const dobval = dateOfBirthid.value

        if(!dobval){
            error3.style.display = "block"
            error3.innerHTML = "please enter your date of birth"
        }
        // const dobpattern=/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[0-2])-\d{4}$/
        const dobpattern = /^\d{4}-\d{2}-\d{2}$/;


        if (!dobpattern.test(dobval)) {
            error3.style.display = "block"
            error3.innerHTML = "Invalid Format"
        }else{
             error3.style.display="none"
             error3.innerHTML=""
        }
      }
      function passValidateChecking(e){
        const passval=passid.value
        const cpassval=confirmPassid.value
        const passpattern=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{6,}$/

        if (!passval) {
           error4.style.display = "block"
           error4.innerHTML = "Password is required"
       
        }
        if (!cpassval) {
            error5.style.display = "block"
            error5.innerHTML = "Please confirm your password"
        }


        if(!passpattern.test(passval)){
            error4.style.display = "block";
            error4.innerHTML = "Password must be at least 6 characters with letters and numbers"
        }else if(passval !== cpassval) {
            error5.style.display = "block"
            error5.innerHTML = "Passwords do not match"
        } else {
            error4.style.display = "none"
            error4.innerHTML = ""
            error5.style.display = "none"
            error5.innerHTML = ""
         }
    }


    document.addEventListener("DOMContentLoaded",()=>{
        signUpForm.addEventListener("submit",(e)=>{
            nameValidateChecking()
            emailValidateChecking()
            dobValidateChecking()
            passValidateChecking()

            if(!nameid||!emailid||!dateOfBirthid||!passid||!error1||!error2||!error3||!error4||!error5||!signUpForm){
                console.error("one or more elements not fount")
            }

            if(error1.innerHTML||error2.innerHTML||error3.innerHTML||error4.innerHTML||error5.innerHTML){
                e.preventDefault()
            }
        })
    })



    </script>
</body>
</html>